openapi: '3.0.0'
info:
  title: RESTful EPP
  version: '1.0'
servers:
  - url: http://localhost:8080/repp/v1/

paths:
# common
  /:
    get:
      summary: Hello
      tags:
        - common
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string               

  /messages:
    get:
      summary: Poll request
      tags:
        - common
      parameters:
        - $ref: '#/components/parameters/p_cltrid'
        - $ref: '#/components/parameters/p_svcs'
        - $ref: '#/components/parameters/p_svcs-ext'
        - $ref: '#/components/parameters/p_acceptLanguage'
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
  /messages/{id}:
    head:
      summary: Poll ack
      tags:
        - common
      parameters:
        - $ref: '#/components/parameters/p_id'
        - $ref: '#/components/parameters/p_cltrid'
        - $ref: '#/components/parameters/p_svcs'
        - $ref: '#/components/parameters/p_svcs-ext'
        - $ref: '#/components/parameters/p_acceptLanguage'
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string     
              application/epp+json:
                schema:
                  type: string 

 # domains
  /domains/{id}:
    parameters:
     - $ref: '#/components/parameters/p_id'
     - $ref: '#/components/parameters/p_cltrid'
     - $ref: '#/components/parameters/p_svcs'
     - $ref: '#/components/parameters/p_svcs-ext'
     - $ref: '#/components/parameters/p_acceptLanguage'
    head:
      summary: Domain check
      tags:
        - domains
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    get:
      summary: Domain info
      tags:
        - domains
      parameters:
        - name: filter
          in: query
          required: false
          schema:
            type: string
        - name: val
          in: query
          required: false
          schema:
            type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    post:
      summary: Domain info using request message body
      tags:
        - domains
      parameters:
        - name: attr
          in: query
          required: false
          schema:
            type: string
        - name: val
          in: query
          required: false
          schema:
            type: string
      requestBody:
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
            schema:
              type: string

      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    delete:
      summary: Domain delete
      tags:
        - domains
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string       

    patch:
      summary: Domain update
      tags:
        - domains
      requestBody:
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
                schema:
                  type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
                  

  /domains:
    parameters:
     - $ref: '#/components/parameters/p_cltrid'
     - $ref: '#/components/parameters/p_svcs'
     - $ref: '#/components/parameters/p_svcs-ext'
     - $ref: '#/components/parameters/p_acceptLanguage'
    post:
      summary: Domain create
      tags:
        - domains
      requestBody:
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
                schema:
                  type: string
      responses:
          '201':
            description: CREATED
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string

  /domains/{id}/renewals:
    parameters:
     - $ref: '#/components/parameters/p_id'
     - $ref: '#/components/parameters/p_cltrid'
     - $ref: '#/components/parameters/p_svcs'
     - $ref: '#/components/parameters/p_svcs-ext'
     - $ref: '#/components/parameters/p_acceptLanguage'
    post:
      summary: Domain renew
      tags:
        - domains
      requestBody:
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
                schema:
                  type: string
      responses:
          '201':
            description: CREATED
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string

  /domains/{id}/transfers:
    parameters:
     - $ref: '#/components/parameters/p_id'
     - $ref: '#/components/parameters/p_cltrid'
     - $ref: '#/components/parameters/p_svcs'
     - $ref: '#/components/parameters/p_svcs-ext'
     - $ref: '#/components/parameters/p_acceptLanguage'
    post:
      summary: Domain transfer request
      tags:
        - domains
      requestBody:
        required: false
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
                schema:
                  type: string
      responses:
          '201':
            description: CREATED
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
                
  /domains/{id}/transfers/latest:
    parameters:
     - $ref: '#/components/parameters/p_id'
     - $ref: '#/components/parameters/p_cltrid'
     - $ref: '#/components/parameters/p_svcs'
     - $ref: '#/components/parameters/p_svcs-ext'
     - $ref: '#/components/parameters/p_acceptLanguage'
    get:
      summary: Domain transfer query
      tags:
        - domains
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    post:
      summary: Domain transfer query using message body
      tags:
        - domains
      requestBody:
        required: false
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
                schema:
                  type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    
    delete:
      summary: Domain transfer cancel
      tags:
        - domains
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
            
    put:
      summary: Domain transfer approve
      tags:
        - domains
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string


 # hosts
  /hosts/{id}:
    parameters:
     - $ref: '#/components/parameters/p_id'
     - $ref: '#/components/parameters/p_cltrid'
     - $ref: '#/components/parameters/p_svcs'
     - $ref: '#/components/parameters/p_svcs-ext'
     - $ref: '#/components/parameters/p_acceptLanguage'
    head:
      summary: Host check
      tags:
        - hosts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    get:
      summary: Host info
      tags:
        - hosts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
        - name: attr
          in: query
          required: false
          schema:
            type: string
        - name: val
          in: query
          required: false
          schema:
            type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    post:
      summary: Host info using request message body
      tags:
        - hosts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
                schema:
                  type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    delete:
      summary: Host delete
      tags:
        - hosts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string       
              application/epp+json:
                schema:
                  type: string

    patch:
      summary: Host update
      tags:
        - hosts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
                schema:
                  type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
                  

  /hosts:
    parameters:
     - $ref: '#/components/parameters/p_cltrid'
     - $ref: '#/components/parameters/p_svcs'
     - $ref: '#/components/parameters/p_svcs-ext'
     - $ref: '#/components/parameters/p_acceptLanguage'
    post:
      summary: Host create
      tags:
        - hosts
      requestBody:
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
                schema:
                  type: string
      responses:
          '201':
            description: CREATED
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string

 
 # contacts
  /contacts/{id}:
    parameters:
     - $ref: '#/components/parameters/p_id'
     - $ref: '#/components/parameters/p_cltrid'
     - $ref: '#/components/parameters/p_svcs'
     - $ref: '#/components/parameters/p_svcs-ext'
     - $ref: '#/components/parameters/p_acceptLanguage'
    head:
      summary: Contact check
      tags:
        - contacts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    get:
      summary: Contact info
      tags:
        - contacts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
        - name: attr
          in: query
          required: false
          schema:
            type: string
        - name: val
          in: query
          required: false
          schema:
            type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    post:
      summary: Contact info using request message body
      tags:
        - contacts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
        - name: attr
          in: query
          required: false
          schema:
            type: string
        - name: val
          in: query
          required: false
          schema:
            type: string
      requestBody:
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
            schema:
              type: string

      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    delete:
      summary: Contact delete
      tags:
        - contacts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string       

    patch:
      summary: Contact update
      tags:
        - contacts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
                schema:
                  type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
                  

  /contacts:
    parameters:
     - $ref: '#/components/parameters/p_cltrid'
     - $ref: '#/components/parameters/p_svcs'
     - $ref: '#/components/parameters/p_svcs-ext'
     - $ref: '#/components/parameters/p_acceptLanguage'
    post:
      summary: Contact create
      tags:
        - contacts
      requestBody:
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
                schema:
                  type: string
      responses:
          '201':
            description: CREATED
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string

  /contacts/{id}/transfers:
    parameters:
     - $ref: '#/components/parameters/p_id'
     - $ref: '#/components/parameters/p_cltrid'
     - $ref: '#/components/parameters/p_svcs'
     - $ref: '#/components/parameters/p_svcs-ext'
     - $ref: '#/components/parameters/p_acceptLanguage'
    post:
      summary: Contact transfer request
      tags:
        - contacts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: false
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
                schema:
                  type: string
      responses:
          '201':
            description: CREATED
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
                
  /contacts/{id}/transfers/latest:
    parameters:
     - $ref: '#/components/parameters/p_id'
     - $ref: '#/components/parameters/p_cltrid'
     - $ref: '#/components/parameters/p_svcs'
     - $ref: '#/components/parameters/p_svcs-ext'
     - $ref: '#/components/parameters/p_acceptLanguage'
    get:
      summary: Contact transfer query
      tags:
        - contacts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    post:
      summary: Contact transfer query using message body
      tags:
        - contacts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: false
        content:
          application/epp+xml:
            schema:
              type: string
          application/epp+json:
                schema:
                  type: string
      responses:
          '200':
            description: OK
            content:
              application/epp+xml:
                schema:
                  type: string
              application/epp+json:
                schema:
                  type: string
    
    delete:
      summary: Contact transfer cancel
      tags:
        - contacts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
          '200':
            $ref: '#/components/responses/200okWithBody'
            
    put:
      summary: Contact transfer approve
      tags:
        - contacts
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          $ref: '#/components/responses/200okWithBody'


#
# Components
#   
components:
  parameters:
    p_id:
      name: id
      description: Object identifier
      in: path
      required: true
      schema:
         type: string
    p_cltrid:
      name: REPP-cltrid
      description: Client transaction identifier
      in: header
      schema:
        type: string
      required: false
    p_svcs:
      name: REPP-svcs
      description: Namespace used
      in: header
      schema:
        type: string
      required: true
    p_svcs-ext:
      name: REPP-svcs-ext
      description: Extension namespace used
      in: header
      schema:
        type: string
      required: false
    p_authinfo:
      name: REPP-authInfo
      description: Object authorization details
      in: header
      schema:
        type: string
      required: false
    p_acceptLanguage:
      in: header
      name: Accept-Language
      description: Language used for response
      schema:
        type: string
      required: true

      
      
  headers:
    cltrid:
      description: Client transaction identifier
      schema:
        type: string
      required: false
    svtrid:
      description: Server transaction identifier
      schema:
        type: string
      required: false
    eppcode:
      description: EPP result code
      schema:
        type: integer
      required: false
    queue-size:
      description: Number of messages in the queue
      schema:
        type: integer
      required: false
      
  responses:
    200okWithBody:
      description: OK
      content:
        application/epp+xml:
           schema:
             type: string
        application/epp+json:
           schema:
             type: string
      headers:
        REPP-cltrid:
          $ref: '#/components/headers/cltrid'
        REPP-svtrid:
          $ref: '#/components/headers/svtrid'
        REPP-eppcode:
          $ref: '#/components/headers/eppcode'
        REPP-Queue-Size:
          $ref: '#/components/headers/queue-size'
      